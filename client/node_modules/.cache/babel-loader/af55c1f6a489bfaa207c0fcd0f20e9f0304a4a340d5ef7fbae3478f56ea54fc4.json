{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useCart}from'../context/CartContext';import Header from'../components/Header';import Footer from'../components/Footer';import'../styles/Profile.css';import{FiUser,FiLogOut}from'react-icons/fi';import NeonButton from'../components/NeonButton';import{Link}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Profile=()=>{const{user,fetchCurrentUser,logout}=useCart();const[loading,setLoading]=useState(true);const[userOrders,setUserOrders]=useState([]);// Статусы с переводом\nconst statusOptions=[{value:'pending',label:'Ожидает'},{value:'processing',label:'В обработке'},{value:'shipped',label:'Отправлен'},{value:'delivered',label:'Доставлен'},{value:'cancelled',label:'Отменен'}];// Форматируем дату\nconst formatDate=dateString=>{const date=new Date(dateString);return isNaN(date.getTime())?'Неверная дата':date.toLocaleString();};// Получаем лейбл статуса\nconst getStatusLabel=status=>{const option=statusOptions.find(opt=>opt.value===status);return option?option.label:'Неизвестный статус';};// Загрузка данных пользователя и его заказов\nuseEffect(()=>{const loadUserAndOrders=async()=>{try{// Загружаем заказы только если пользователь уже есть\nif(user&&user.id){const orders=JSON.parse(localStorage.getItem('orders'))||[];const filteredOrders=orders.filter(order=>order.userId===user.id);setUserOrders(filteredOrders);}}finally{setLoading(false);}};loadUserAndOrders();},[user===null||user===void 0?void 0:user.id]);if(loading){return/*#__PURE__*/_jsx(\"div\",{children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430 \\u043F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044F...\"});}if(!user){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsxs(\"main\",{className:\"profile-page\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u0412\\u044B \\u043D\\u0435 \\u0430\\u0432\\u0442\\u043E\\u0440\\u0438\\u0437\\u043E\\u0432\\u0430\\u043D\\u044B\"}),/*#__PURE__*/_jsx(\"p\",{children:\"\\u041F\\u043E\\u0436\\u0430\\u043B\\u0443\\u0439\\u0441\\u0442\\u0430, \\u0432\\u043E\\u0439\\u0434\\u0438\\u0442\\u0435, \\u0447\\u0442\\u043E\\u0431\\u044B \\u0443\\u0432\\u0438\\u0434\\u0435\\u0442\\u044C \\u0441\\u0432\\u043E\\u0439 \\u043F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C.\"}),/*#__PURE__*/_jsx(Link,{to:\"/auth\",children:/*#__PURE__*/_jsx(NeonButton,{fullWidth:true,children:\"\\u041F\\u0435\\u0440\\u0435\\u0439\\u0442\\u0438 \\u043A \\u0430\\u0432\\u0442\\u043E\\u0440\\u0438\\u0437\\u0430\\u0446\\u0438\\u0438\"})})]}),/*#__PURE__*/_jsx(Footer,{})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"app\",children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsxs(\"main\",{className:\"profile-page\",children:[/*#__PURE__*/_jsxs(\"section\",{className:\"profile-section\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"page-title\",children:\"\\u041F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"profile-avatar\",children:/*#__PURE__*/_jsx(FiUser,{size:60})}),/*#__PURE__*/_jsx(\"h2\",{children:user===null||user===void 0?void 0:user.name}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Email:\"}),\" \",user===null||user===void 0?void 0:user.email]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"ID:\"}),\" \",user===null||user===void 0?void 0:user.id]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0420\\u043E\\u043B\\u044C:\"}),\" \",user!==null&&user!==void 0&&user.isAdmin?'Администратор':'Пользователь']}),/*#__PURE__*/_jsxs(NeonButton,{onClick:logout,fullWidth:true,danger:true,children:[/*#__PURE__*/_jsx(FiLogOut,{style:{marginRight:'8px'}}),\" \\u0412\\u044B\\u0439\\u0442\\u0438\"]})]})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"orders-section\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"section-title\",children:\"\\u0412\\u0430\\u0448\\u0438 \\u0437\\u0430\\u043A\\u0430\\u0437\\u044B\"}),userOrders.length===0?/*#__PURE__*/_jsx(\"p\",{children:\"\\u0423 \\u0432\\u0430\\u0441 \\u043F\\u043E\\u043A\\u0430 \\u043D\\u0435\\u0442 \\u0437\\u0430\\u043A\\u0430\\u0437\\u043E\\u0432\"}):/*#__PURE__*/_jsx(\"div\",{className:\"orders-list\",children:userOrders.map(order=>/*#__PURE__*/_jsxs(\"div\",{className:\"order-item\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u041D\\u043E\\u043C\\u0435\\u0440 \\u0437\\u0430\\u043A\\u0430\\u0437\\u0430:\"}),\" #\",order.id]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0414\\u0430\\u0442\\u0430:\"}),\" \",formatDate(order.date)]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0421\\u0442\\u0430\\u0442\\u0443\\u0441:\"}),' ',/*#__PURE__*/_jsx(\"span\",{className:`status-badge ${order.status||'pending'}`,children:getStatusLabel(order.status)})]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0418\\u0442\\u043E\\u0433\\u043E:\"}),\" \",order.total.toLocaleString(),\" \\u20BD\"]})]},order.id))})]})]}),/*#__PURE__*/_jsx(Footer,{})]});};export default Profile;","map":{"version":3,"names":["React","useEffect","useState","useCart","Header","Footer","FiUser","FiLogOut","NeonButton","Link","jsx","_jsx","jsxs","_jsxs","Profile","user","fetchCurrentUser","logout","loading","setLoading","userOrders","setUserOrders","statusOptions","value","label","formatDate","dateString","date","Date","isNaN","getTime","toLocaleString","getStatusLabel","status","option","find","opt","loadUserAndOrders","id","orders","JSON","parse","localStorage","getItem","filteredOrders","filter","order","userId","children","className","to","fullWidth","size","name","email","isAdmin","onClick","danger","style","marginRight","length","map","total"],"sources":["C:/Users/dinat/OneDrive/Рабочий стол/lining/client/src/pages/Profile.js"],"sourcesContent":["\r\nimport React, { useEffect, useState } from 'react';\r\nimport { useCart } from '../context/CartContext';\r\nimport Header from '../components/Header';\r\nimport Footer from '../components/Footer';\r\nimport '../styles/Profile.css';\r\nimport { FiUser, FiLogOut } from 'react-icons/fi';\r\nimport NeonButton from '../components/NeonButton';\r\nimport { Link } from 'react-router-dom';\r\n\r\nconst Profile = () => {\r\n  const { user, fetchCurrentUser, logout } = useCart();\r\n  const [loading, setLoading] = useState(true);\r\n  const [userOrders, setUserOrders] = useState([]);\r\n\r\n  // Статусы с переводом\r\n  const statusOptions = [\r\n    { value: 'pending', label: 'Ожидает' },\r\n    { value: 'processing', label: 'В обработке' },\r\n    { value: 'shipped', label: 'Отправлен' },\r\n    { value: 'delivered', label: 'Доставлен' },\r\n    { value: 'cancelled', label: 'Отменен' }\r\n  ];\r\n\r\n  // Форматируем дату\r\n  const formatDate = (dateString) => {\r\n    const date = new Date(dateString);\r\n    return isNaN(date.getTime()) ? 'Неверная дата' : date.toLocaleString();\r\n  };\r\n\r\n  // Получаем лейбл статуса\r\n  const getStatusLabel = (status) => {\r\n    const option = statusOptions.find(opt => opt.value === status);\r\n    return option ? option.label : 'Неизвестный статус';\r\n  };\r\n\r\n  // Загрузка данных пользователя и его заказов\r\n useEffect(() => {\r\n  const loadUserAndOrders = async () => {\r\n    try {\r\n      // Загружаем заказы только если пользователь уже есть\r\n      if (user && user.id) {\r\n        const orders = JSON.parse(localStorage.getItem('orders')) || [];\r\n        const filteredOrders = orders.filter(order => order.userId === user.id);\r\n        setUserOrders(filteredOrders);\r\n      }\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  loadUserAndOrders();\r\n}, [user?.id]);\r\n\r\n  if (loading) {\r\n    return <div>Загрузка профиля...</div>;\r\n  }\r\n\r\n  if (!user) {\r\n    return (\r\n      <div>\r\n        <Header />\r\n        <main className=\"profile-page\">\r\n          <h2>Вы не авторизованы</h2>\r\n          <p>Пожалуйста, войдите, чтобы увидеть свой профиль.</p>\r\n          <Link to=\"/auth\">\r\n            <NeonButton fullWidth>Перейти к авторизации</NeonButton>\r\n          </Link>\r\n        </main>\r\n        <Footer />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"app\">\r\n      <Header />\r\n      <main className=\"profile-page\">\r\n        <section className=\"profile-section\">\r\n          <h1 className=\"page-title\">Профиль</h1>\r\n\r\n          <div className=\"profile-card\">\r\n            <div className=\"profile-avatar\">\r\n              <FiUser size={60} />\r\n            </div>\r\n            <h2>{user?.name}</h2>\r\n            <p><strong>Email:</strong> {user?.email}</p>\r\n            <p><strong>ID:</strong> {user?.id}</p>\r\n            <p><strong>Роль:</strong> {user?.isAdmin ? 'Администратор' : 'Пользователь'}</p>\r\n\r\n            <NeonButton \r\n              onClick={logout} \r\n              fullWidth \r\n              danger\r\n            >\r\n              <FiLogOut style={{ marginRight: '8px' }} /> Выйти\r\n            </NeonButton>\r\n          </div>\r\n        </section>\r\n\r\n        {/* История заказов */}\r\n        <section className=\"orders-section\">\r\n          <h2 className=\"section-title\">Ваши заказы</h2>\r\n\r\n          {userOrders.length === 0 ? (\r\n            <p>У вас пока нет заказов</p>\r\n          ) : (\r\n            <div className=\"orders-list\">\r\n              {userOrders.map((order) => (\r\n                <div key={order.id} className=\"order-item\">\r\n                  <p><strong>Номер заказа:</strong> #{order.id}</p>\r\n                  <p><strong>Дата:</strong> {formatDate(order.date)}</p>\r\n                  <p>\r\n                    <strong>Статус:</strong>{' '}\r\n                    <span className={`status-badge ${order.status || 'pending'}`}>\r\n                      {getStatusLabel(order.status)}\r\n                    </span>\r\n                  </p>\r\n                  <p><strong>Итого:</strong> {order.total.toLocaleString()} ₽</p>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </section>\r\n      </main>\r\n      <Footer />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Profile;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}